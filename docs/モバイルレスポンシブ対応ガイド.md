# TRYPAS モバイルレスポンシブ対応 実装ガイド

## 問題点の分析

### 現在の問題
- **iPhone SE (375x667)**: ゲーム盤の下部コマとボタンが重なる
- タイマーと凡例がゲーム盤と重なる
- 固定的なスペーシング（`mb-4`、`gap-3`等）が小画面に対応していない

### 原因
1. App.jsxで `justify-between` を使用し、要素を強制的に画面端に配置
2. ゲーム盤のサイズが動的ではなく、利用可能な高さを考慮していない
3. 各要素のマージン・パディングが固定値

## 解決策

### 1. ビューポート高さの動的計算
- `main.jsx`でビューポート高さを`--vh`変数として設定 ✅ 完了
- `index.css`で`100dvh`および`-webkit-fill-available`を使用 ✅ 完了

### 2. Tailwind設定の拡張
- `h-screen-dynamic`などのカスタムユーティリティを追加 ✅ 完了

### 3. App.jsxの修正（必須）

#### 修正が必要な箇所

**現在のコード (193行目付近):**
```jsx
className="w-full h-full flex flex-col items-center justify-between"
```

**修正後:**
```jsx
className="w-full h-full flex flex-col items-center justify-start"
style={{
  gap: 'clamp(0.25rem, 1vh, 0.75rem)',
  padding: 'clamp(0.25rem, 0.5vh, 0.5rem)'
}}
```

**ヘッダーエリア (197行目付近):**
```jsx
// 現在
className="w-full flex-shrink-0 flex flex-row items-start justify-between mb-4 px-2"

// 修正後
className="w-full flex-shrink-0 flex flex-row items-start justify-between px-2"
style={{ marginBottom: 'clamp(0.25rem, 1vh, 1rem)' }}
```

**ロゴ (201-205行目):**
```jsx
// 現在
className="w-[140px] opacity-90 drop-shadow-lg"

// 修正後  
className="opacity-90 drop-shadow-lg"
style={{ width: 'clamp(90px, 25vw, 140px)' }}
```

**ゲーム盤コンテナ (249-257行目):**
```jsx
// 現在
<div className="flex-shrink-1 w-full flex items-center justify-center min-h-0">
  <div className="w-full max-w-[400px] aspect-square max-h-full">

// 修正後
<div className="flex-1 w-full flex items-center justify-center min-h-0">
  <div className="w-full aspect-square" style={{
    maxWidth: 'min(400px, calc(100vw - 2rem), calc(var(--vh, 1vh) * 100 - 280px))',
    maxHeight: 'calc(var(--vh, 1vh) * 100 - 280px)'
  }}>
```

**フッターエリア (264行目から):**
```jsx
// 現在
className="w-full flex-shrink-0 flex flex-col items-center gap-3 mb-2"

// 修正後
className="w-full flex-shrink-0 flex flex-col items-center mb-2"
style={{ gap: 'clamp(0.25rem, 0.5vh, 0.75rem)' }}
```

**タイマー (269行目):**
```jsx
// 現在
className="text-2xl font-black font-mono tracking-widest text-blue-300..."

// 修正後
className="font-black font-mono tracking-widest text-blue-300..."
style={{ fontSize: 'clamp(1.125rem, 4vw, 1.75rem)' }}
```

**コントロールボタンエリア (282行目):**
```jsx
// 現在
className="w-full flex gap-3 mt-1"

// 修正後
className="w-full flex mt-1"
style={{ gap: 'clamp(0.375rem, 1vw, 0.75rem)' }}
```

**個別ボタン (283-285,286-288行目):**
```jsx
// 現在
className="flex-1 py-3 bg-gray-800..."

// 修正後
className="flex-1 bg-gray-800..."
style={{ 
  padding: 'clamp(0.5rem, 1.5vh, 0.75rem) 0.5rem',
  fontSize: 'clamp(0.7rem, 2.5vw, 0.875rem)'
}}
```

### 4. Legend.jsxとScoreBoard.jsxの修正

#### Legend.jsx
フォントサイズを動的に:
```jsx
style={{ fontSize: 'clamp(0.625rem, 2vw, 0.75rem)' }}
```

#### ScoreBoard.jsx
コンパクトモード時のパディングを削減:
```jsx
style={{ padding: 'clamp(0.25rem, 1vh, 0.5rem)' }}
```

## 実装手順

1. ✅ `index.html` - viewportメタタグ更新
2. ✅ `index.css` - 動的vh対応
3. ✅ `main.jsx` - ビューポート高さ計算スクリプト追加
4. ✅ `tailwind.config.js` - カスタムユーティリティ追加
5. ⏳ `App.jsx` - レイアウト修正（上記の変更を適用）
6. ⏳ `Legend.jsx` - フォントサイズ動的化
7. ⏳ `ScoreBoard.jsx` - パディング動的化

## テスト項目

### 必須テスト解像度
- ✅ iPhone SE (375x667) - **最優先**
- ✅ iPhone 12 Pro (390x844)
- ✅ iPhone 14 Pro Max (430x932)
- ✅ Samsung Galaxy S20 (360x800)
- ✅ iPad Mini (768x1024)

### 確認ポイント
- [ ] すべての要素が重ならない
- [ ] ゲーム盤のすべてのコマがクリック可能
- [ ] スクロールが発生しない
- [ ] タイマーと凡例が見える
- [ ] すべてのボタンが見えてクリック可能

## 推定改善効果

- iPhone SE: 重なり解消、完全にプレイ可能
- その他の端末: レイアウトの改善、より洗練された表示

---

**実装日**: 2025-12-29
**担当**: アンチグラビティ
